import{_ as k}from"./BUM13SZ-.js";import{e as B,g as L,j,r as u,c,a as s,q as v,v as _,h as n,I as h,d as o,b as C,w as I,t as x,D as P,G as T,o as p,_ as U}from"./SynJIhq3.js";import{_ as A}from"./DMjXLAgn.js";import{v as D}from"./e1oNXNuD.js";import{u as E}from"./CGqtJiqE.js";const N={class:"container min-vh-100 d-flex align-items-center justify-content-center"},V={class:"col-12 col-md-8 col-lg-5"},z={class:"card shadow-sm border-0"},K={class:"card-body p-4 p-md-5"},M={class:"mb-3"},R=["disabled"],J={class:"mb-4"},W=["disabled"],q=["disabled"],F={key:0},G={key:1,class:"d-inline-flex align-items-center"},O={class:"text-center"},Y={class:"text-muted"},Z={class:"text-center mt-3"},$={class:"text-muted"},H=B({__name:"login-internal",setup(Q){const f=P(),d=L(),y=j(),w=E(),r=u(""),a=u(""),t=u(!1);async function b(){var l;if(!t.value){if(!r.value.trim()){d.show("Bitte gib einen Benutzernamen ein.");return}if(!a.value){d.show("Bitte gib ein Passwort ein.");return}t.value=!0;try{const e=await $fetch("/login",{method:"POST",baseURL:f.public.apiBase,credentials:f.public.apiWithCredentials?"include":"omit",headers:{"Content-Type":"application/json"},body:{username:r.value.trim(),password:a.value}}),{token:m,username:i,roles:S}=e;localStorage.setItem("jwt",m),w.setUsername(i),console.log("roles: "+S),y.success("Erfolgreich angemeldet!"),await T("/instructor/home")}catch(e){console.error("Login error:",e),t.value=!1,d.show(((l=e==null?void 0:e.data)==null?void 0:l.message)??"Anmeldung fehlgeschlagen. Bitte überprüfe deine Zugangsdaten.")}}}function g(l){l.key==="Enter"&&b()}return(l,e)=>{const m=k;return p(),c("div",N,[s("div",V,[s("div",z,[s("div",K,[e[8]||(e[8]=s("div",{class:"text-center mb-4"},[s("img",{src:A,alt:"Logo der Johanna-Moosdorf-Schule",class:"img-fluid",style:{"max-height":"120px","object-fit":"contain"},loading:"eager"})],-1)),e[9]||(e[9]=s("h1",{class:"h4 mb-2 text-center"},"iLA Login",-1)),e[10]||(e[10]=s("p",{class:"text-muted mb-4 text-center"}," Anmeldung für Nutzer ohne IServ-Konto ",-1)),s("div",M,[e[2]||(e[2]=s("label",{for:"username",class:"form-label"},"Benutzername",-1)),v(s("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=i=>h(r)?r.value=i:null),type:"text",class:"form-control",placeholder:"Benutzername eingeben",disabled:n(t),autocomplete:"username",onKeypress:g},null,40,R),[[_,n(r)]])]),s("div",J,[e[3]||(e[3]=s("label",{for:"password",class:"form-label"},"Passwort",-1)),v(s("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=i=>h(a)?a.value=i:null),type:"password",class:"form-control",placeholder:"Passwort eingeben",disabled:n(t),autocomplete:"current-password",onKeypress:g},null,40,W),[[_,n(a)]])]),s("button",{type:"button",class:"btn btn-primary btn-lg w-100 d-flex align-items-center justify-content-center",disabled:n(t),onClick:b},[n(t)?(p(),c("span",G,e[4]||(e[4]=[s("span",{class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},null,-1),o(" Wird angemeldet… ")]))):(p(),c("span",F,"Anmelden"))],8,q),e[11]||(e[11]=s("div",{class:"mt-3 text-center"},[s("small",{class:"text-muted"},[o(" Probleme bei der Anmeldung? "),s("br"),o(" Support Email an "),s("a",{href:"mailto:support@sandbox27.de",class:"link-secondary"},"support@sandbox27.de"),o(" schreiben ")])],-1)),e[12]||(e[12]=s("hr",{class:"my-4"},null,-1)),s("div",O,[s("small",Y,[e[6]||(e[6]=o(" Schüler melden sich über ")),C(m,{to:"/",class:"link-secondary"},{default:I(()=>e[5]||(e[5]=[o("IServ")])),_:1}),e[7]||(e[7]=o(" an. "))])])])]),s("div",Z,[s("small",$," © "+x(new Date().getFullYear())+" Johanna-Moosdorf-Schule | v1.1."+x(n(D).build),1)])])])}}}),oe=U(H,[["__scopeId","data-v-02668ed8"]]);export{oe as default};
