import{z as j,r as u,i as A,P as D,c as n,a as l,j as d,m as I,v as S,F as k,l as b,t as a,d as F,o}from"./B9swkvS2.js";import{_ as L}from"./DlAUqK2U.js";const T={class:"container mt-4"},z={class:"mb-4"},B={key:0,class:"list-group"},q=["onClick"],M={key:0,class:"alert alert-success"},P={key:1,class:"alert alert-warning"},U={key:2,class:"alert alert-danger"},O={key:3},Z={class:"table table-sm"},G=["onClick"],H={class:"mt-4"},J={key:0,class:"list-group"},Q=["onClick"],R={key:1,class:"mt-2"},W={__name:"users_old",setup(X){const{$authFetch:v}=j(),w=u([]),y=u([]),C=u([]),m=u(""),r=u(null),f=u(""),_=u([]),i=u(null),c=u({info:[],warning:[],error:[]}),h=A(()=>{const e=m.value;return e?w.value.filter(t=>{var s,g;return((s=t.firstName)==null?void 0:s.includes(e))||((g=t.lastName)==null?void 0:g.includes(e))}):[]});D(async()=>{w.value=await v("/users"),y.value=await v("/courses")});function x(e){r.value=e,m.value="",h.value=[],p()}async function p(){r.value&&(C.value=await v(`/assignments?user-name=${r.value.userName}`))}function K(){const e=f.value.toLowerCase();_.value=y.value.filter(t=>t.name.toLowerCase().includes(e)||t.courseId.toString().includes(e))}function V(e){console.log("course selected: "+e.name),i.value=e,f.value="",_.value=[]}async function $(){if(!r.value||!i.value)return;const e=await v("/assignments",{method:"POST",body:{userName:r.value.userName,courseId:i.value.courseId}});N(e),await p(),i.value=null}async function E(e){console.log("deleting "+e);const t=await v(`/assignments/${e}`,{method:"DELETE"});N(t),await p()}function N(e){console.log("feedback: "+e.info),c.value={info:e.info||[],warning:e.warning||[],error:e.error||[]}}return(e,t)=>(o(),n("div",T,[t[5]||(t[5]=l("h1",{class:"mb-4"},"Kurszuweisungen verwalten",-1)),l("div",z,[t[2]||(t[2]=l("label",{class:"form-label"},"Schüler suchen",-1)),I(l("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),class:"form-control",placeholder:"Vorname oder Nachname"},null,512),[[S,m.value]]),h.value.length&&m.value?(o(),n("ul",B,[(o(!0),n(k,null,b(h.value,s=>(o(),n("li",{class:"list-group-item list-group-item-action",key:s.username,onClick:g=>x(s)},a(s.firstName)+" "+a(s.lastName)+" ("+a(s.userName)+") ",9,q))),128))])):d("",!0)]),c.value.info.length?(o(),n("div",M,a(c.value.info.join(" ")),1)):d("",!0),c.value.warning.length?(o(),n("div",P,a(c.value.warning.join(" ")),1)):d("",!0),c.value.error.length?(o(),n("div",U,a(c.value.error.join(" ")),1)):d("",!0),r.value?(o(),n("div",O,[l("h5",null,"Kurse von "+a(r.value.firstName)+" "+a(r.value.lastName),1),l("table",Z,[t[3]||(t[3]=l("thead",null,[l("tr",null,[l("th",null,"Kurs"),l("th",null,"Aktion")])],-1)),l("tbody",null,[(o(!0),n(k,null,b(C.value,s=>(o(),n("tr",{key:s.id},[l("td",null,a(s.course.courseId)+": "+a(s.course.name),1),l("td",null,[l("button",{class:"btn btn-danger btn-sm",onClick:g=>E(s.id)},"Entfernen",8,G)])]))),128))])]),l("div",H,[t[4]||(t[4]=l("label",{class:"form-label"},"Kurs hinzufügen",-1)),I(l("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s),onInput:K,class:"form-control",placeholder:"Kursname oder Kurs-ID"},null,544),[[S,f.value]]),_.value.length&&f.value?(o(),n("ul",J,[(o(!0),n(k,null,b(_.value,s=>(o(),n("li",{class:"list-group-item list-group-item-action",key:s.courseId,onClick:g=>V(s)},a(s.name)+" ("+a(s.courseId)+") ",9,Q))),128))])):d("",!0),i.value?(o(),n("div",R,[F(a(i.value.courseId)+": "+a(i.value.name)+" ",1),l("button",{class:"btn btn-primary",onClick:$},"Zuweisen")])):d("",!0)])])):d("",!0)]))}},se=L(W,[["__scopeId","data-v-31348a37"]]);export{se as default};
