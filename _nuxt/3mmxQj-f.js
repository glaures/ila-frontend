import{l as i,j as l,y as s,T as r,c as u,a as p,o as d}from"./mGXWjvNG.js";const h={class:"container py-5 text-center"},y={__name:"auth-redirect",async setup(_){let e,t;const n=i().query.code;if(n){const o=l(),c=`${o.public.baseUrl.replace(/\/$/,"")}${o.public.oauth.redirectPath}`;try{const{token:a}=([e,t]=s(()=>$fetch(o.public.apiBase+"/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:{code:n,redirectUri:c}})),e=await e,t(),e);localStorage.setItem("jwt",a),[e,t]=s(()=>r("/preferences")),await e,t()}catch(a){console.error("Login fehlgeschlagen:",(a==null?void 0:a.data)??a),[e,t]=s(()=>r("/")),await e,t()}}return(o,c)=>(d(),u("div",h,c[0]||(c[0]=[p("p",null,"Authentifiziere dichâ€¦",-1)])))}};export{y as default};
