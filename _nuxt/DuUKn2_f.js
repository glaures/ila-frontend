import{e as y,k as f,c as o,a as s,d as g,t as u,F as x,s as k,h as i,p as h,o as l,M as S,A as F,_ as $,i as z,g as P,j as A,r as w,m as D,H as Z,q as j,C,I as N}from"./SynJIhq3.js";const K={class:"card"},R={class:"card-body"},V={class:"row mb-4"},B={class:"col-md-3 col-sm-6 mb-3"},E={class:"stat-card bg-primary text-white p-3 rounded"},I={class:"stat-value"},M={class:"col-md-3 col-sm-6 mb-3"},O={class:"stat-card bg-warning text-white p-3 rounded"},T={class:"stat-value"},L={class:"col-md-3 col-sm-6 mb-3"},q={class:"stat-card bg-danger text-white p-3 rounded"},H={class:"stat-value"},Q={class:"col-md-3 col-sm-6 mb-3"},U={class:"stat-card bg-info text-white p-3 rounded"},W={class:"stat-value"},G={class:"row mb-4"},J={class:"col-md-6 mb-3"},X={class:"d-flex justify-content-between mb-2"},Y={class:"d-flex justify-content-between mb-2"},ss={class:"d-flex justify-content-between mb-2"},es={class:"col-md-6 mb-3"},ts={class:"d-flex justify-content-between mb-1"},ns={class:"progress",style:{height:"20px"}},is=["aria-valuenow","aria-valuemax"],rs={class:"alert alert-info mb-0"},ls={class:"mb-0"},os={key:0,class:"text-warning"},as=y({__name:"AssignmentResults",props:{result:{}},setup(_){const a=_,b=f(()=>{const t=Object.entries(a.result.priorityDistribution);return t.sort((e,d)=>Number(e[0])-Number(d[0])),Object.fromEntries(t)}),c=f(()=>Object.values(a.result.priorityDistribution).reduce((t,e)=>t+e,0)),m=t=>t===1?"bg-success":t===2?"bg-info":t===3?"bg-warning":"bg-danger";return(t,e)=>(l(),o("div",K,[e[14]||(e[14]=s("div",{class:"card-header bg-success text-white"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-check-circle me-2"}),g(" Zuweisung abgeschlossen ")])],-1)),s("div",R,[s("div",V,[s("div",B,[s("div",E,[s("div",I,u(t.result.assignedStudents),1),e[0]||(e[0]=s("div",{class:"stat-label"},"Vollständig zugewiesen",-1))])]),s("div",M,[s("div",O,[s("div",T,u(t.result.partiallyAssigned),1),e[1]||(e[1]=s("div",{class:"stat-label"},"Teilweise zugewiesen",-1))])]),s("div",L,[s("div",q,[s("div",H,u(t.result.unassigned),1),e[2]||(e[2]=s("div",{class:"stat-label"},"Nicht zugewiesen",-1))])]),s("div",Q,[s("div",U,[s("div",W,u(t.result.assignmentRate.toFixed(1))+"%",1),e[3]||(e[3]=s("div",{class:"stat-label"},"Zuweisungsrate",-1))])])]),s("div",G,[s("div",J,[e[7]||(e[7]=s("h6",{class:"text-muted mb-3"},"Qualitätsmetriken",-1)),s("div",X,[e[4]||(e[4]=s("span",null,"Durchschnittliche Priorität:",-1)),s("strong",null,u(t.result.averagePriority.toFixed(2)),1)]),s("div",Y,[e[5]||(e[5]=s("span",null,"Fairness-Score (Durchschnitt):",-1)),s("strong",null,u(t.result.averageFairnessScore.toFixed(2)),1)]),s("div",ss,[e[6]||(e[6]=s("span",null,"Fairness-Standardabweichung:",-1)),s("strong",null,u(t.result.fairnessStdDeviation.toFixed(2)),1)])]),s("div",es,[e[8]||(e[8]=s("h6",{class:"text-muted mb-3"},"Prioritätsverteilung",-1)),(l(!0),o(x,null,k(i(b),(d,n)=>(l(),o("div",{key:n,class:"mb-2"},[s("div",ts,[s("span",null,"Priorität "+u(n)+":",1),s("strong",null,u(d)+" Zuweisungen",1)]),s("div",ns,[s("div",{class:F(["progress-bar",m(Number(n))]),role:"progressbar",style:S({width:d/i(c)*100+"%"}),"aria-valuenow":d,"aria-valuemin":0,"aria-valuemax":i(c)},u((d/i(c)*100).toFixed(1))+"% ",15,is)])]))),128))])]),s("div",rs,[e[13]||(e[13]=s("h6",{class:"alert-heading"},[s("i",{class:"bi bi-info-circle me-2"}),g(" Interpretation ")],-1)),s("ul",ls,[e[10]||(e[10]=s("li",null,[s("strong",null,"Priorität 1"),g(" bedeutet, dass der Schüler seinen Wunschkurs erhalten hat ")],-1)),e[11]||(e[11]=s("li",null,[g(" Ein niedriger "),s("strong",null,"Fairness-Score"),g(" ist besser (niedrigere Durchschnittspriorität) ")],-1)),e[12]||(e[12]=s("li",null,[g(" Eine niedrige "),s("strong",null,"Standardabweichung"),g(" bedeutet, dass die Zuweisungen fair verteilt sind ")],-1)),t.result.unassigned>0?(l(),o("li",os,e[9]||(e[9]=[s("strong",null,"Nicht zugewiesene Schüler",-1),g(" sollten manuell nachbearbeitet werden ")]))):h("",!0)])])])]))}}),ds=$(as,[["__scopeId","data-v-a31d06c3"]]),us=()=>{const{$authFetch:_}=z(),a=P(),b=A(),c=w(!1),m=w(null);return{isAssigning:c,assignmentResult:m,assignCourses:async e=>{var d;c.value=!0,m.value=null;try{const n=await _(`/periods/${e}/assign-courses`,{method:"POST"});return m.value=n,b.success("Kurszuweisung erfolgreich abgeschlossen!"),n}catch(n){return console.error("Fehler bei der Kurszuweisung:",n),a.show(((d=n==null?void 0:n.data)==null?void 0:d.message)??"Fehler bei der Kurszuweisung: "+n),null}finally{c.value=!1}}}},cs={class:"container my-3"},ms={class:"row"},gs={class:"col-12"},bs={class:"card mb-4"},vs={class:"card-body"},hs={class:"row align-items-center"},_s={class:"col-md-6"},ws=["disabled"],ps=["value"],fs={class:"col-md-6 mt-3 mt-md-0"},ys=["disabled"],xs={key:0,class:"spinner-border spinner-border-sm me-2"},ks={key:1},$s={key:2},zs={key:0,class:"alert alert-warning mb-4"},Ss={key:1,class:"card mb-4"},Fs=y({__name:"zuweisungs-prozess",setup(_){const{isAssigning:a,assignmentResult:b,assignCourses:c}=us(),m=w([]),t=w(null),e=async()=>{try{const{$authFetch:n}=z();m.value=await n("/periods");const r=m.value.find(p=>p.current);r&&(t.value=r.id)}catch(n){console.error("Fehler beim Laden der Zeiträume:",n)}},d=async()=>{!t.value||!confirm("Möchten Sie wirklich die Kurszuweisung für diesen Zeitraum durchführen? Alle bestehenden (nicht-manuellen) Zuweisungen werden gelöscht.")||await c(t.value)};return D(()=>{e()}),(n,r)=>{const p=ds;return l(),o("div",cs,[r[5]||(r[5]=s("div",{class:"d-flex align-items-center justify-content-between mb-3"},[s("div",{class:"h4 m-0"},"Zuweisungs-Prozess")],-1)),s("div",ms,[s("div",gs,[s("div",bs,[s("div",vs,[r[2]||(r[2]=s("h5",{class:"card-title"},"Zeitraum auswählen",-1)),s("div",hs,[s("div",_s,[j(s("select",{"onUpdate:modelValue":r[0]||(r[0]=v=>N(t)?t.value=v:null),class:"form-select",disabled:i(a)},[r[1]||(r[1]=s("option",{value:null},"Bitte wählen...",-1)),(l(!0),o(x,null,k(i(m),v=>(l(),o("option",{key:v.id,value:v.id},u(v.name),9,ps))),128))],8,ws),[[C,i(t)]])]),s("div",fs,[s("button",{class:"btn btn-primary btn-lg w-100",disabled:!i(t)||i(a),onClick:d},[i(a)?(l(),o("span",xs)):h("",!0),i(a)?(l(),o("span",ks,"Zuweisen läuft...")):(l(),o("span",$s,"Kurse zuweisen"))],8,ys)])])])]),i(t)?(l(),o("div",zs,r[3]||(r[3]=[s("strong",null,"Achtung:",-1),g(" Die Kurszuweisung löscht alle bestehenden (nicht-manuellen) Zuweisungen für den gewählten Zeitraum und erstellt sie neu. Dieser Vorgang kann nicht rückgängig gemacht werden. ")]))):h("",!0),i(a)?(l(),o("div",Ss,r[4]||(r[4]=[s("div",{class:"card-body text-center py-5"},[s("div",{class:"spinner-border text-primary mb-3",style:{width:"3rem",height:"3rem"}}),s("h5",null,"Kurse werden zugewiesen..."),s("p",{class:"text-muted"},"Dies kann einige Minuten dauern.")],-1)]))):h("",!0),i(b)&&!i(a)?(l(),Z(p,{key:2,result:i(b),class:"mb-4"},null,8,["result"])):h("",!0)])])])}}}),As=$(Fs,[["__scopeId","data-v-44f6f54f"]]);export{As as default};
