import{k as y,r as d,m as _,c as s,a as e,p as k,d as x,t as r,F as p,i as f,o as a,n as P,T as N}from"./BBA-slmR.js";const w={class:"p-4"},V={key:0,class:"text-muted"},A={key:1},B={class:"mb-2"},C=["disabled"],F={key:0,class:"mt-4"},I={class:"table table-sm table-bordered mt-2 mb-0"},K={__name:"assignment-process",setup(L){const{$authFetch:m}=y(),i=d(null),b=d(!0),o=d(!1),l=d(null);async function h(){try{i.value=await m("/periods/current")}catch(u){console.error(u)}finally{b.value=!1}}async function g(){var u;if((u=i.value)!=null&&u.id){o.value=!0,l.value=null;try{l.value=await m("/assignment-process/1",{method:"POST"}),await N("/admin/assignments")}catch(t){l.value="Fehler: "+t.message}finally{o.value=!1}}}return _(h),(u,t)=>{var v;return a(),s("div",w,[t[3]||(t[3]=e("h1",{class:"h4 mb-4"},"Kursvergabe starten",-1)),b.value?(a(),s("div",V,"Lade aktuelle Phase...")):(a(),s("div",A,[e("p",B,[t[0]||(t[0]=x(" Aktuelle Phase: ")),e("strong",null,r(((v=i.value)==null?void 0:v.name)||"Unbekannt"),1)]),e("button",{onClick:g,disabled:o.value,class:"btn btn-primary mb-4"},r(o.value?"Vergabe läuft...":"Kursvergabe starten"),9,C),l.value&&l.value.students?(a(),s("div",F,[t[2]||(t[2]=e("h2",{class:"h5 mb-3"},"Vergabeübersicht",-1)),(a(!0),s(p,null,f(l.value.students,c=>(a(),s("div",{key:c.studentName,class:"mb-4 border rounded p-3 bg-light"},[e("h5",null,r(c.studentName),1),e("table",I,[t[1]||(t[1]=e("thead",null,[e("tr",null,[e("th",null,"Block"),e("th",null,"Kurs"),e("th",null,"Präferenz")])],-1)),e("tbody",null,[(a(!0),s(p,null,f(c.weeklyPlan,n=>(a(),s("tr",{key:n.blockLabel},[e("td",null,r(n.blockLabel),1),e("td",null,r(n.courseName),1),e("td",null,[e("span",{class:P({"text-muted":n.preferenceIndex===-1,"fw-bold":n.preferenceIndex===0})},r(n.preferenceIndex===-1?"PAUSE":n.preferenceIndex+1),3)])]))),128))])])]))),128))])):k("",!0)]))])}}};export{K as default};
