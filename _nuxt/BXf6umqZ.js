import{i as y,r as o,m as _,c as s,a as e,p as x,d as k,t as l,F as v,s as f,o as a,A as P,G as N}from"./Bt8ervS0.js";const w={class:"p-4"},A={key:0,class:"text-muted"},V={key:1},B={class:"mb-2"},C=["disabled"],I={key:0,class:"mt-4"},L={class:"table table-sm table-bordered mt-2 mb-0"},S={__name:"assignment-process",setup(F){const{$authFetch:m}=y(),d=o(null),b=o(!0),u=o(!1),r=o(null);async function g(){try{d.value=await m("/periods/current")}finally{b.value=!1}}async function h(){var i;if((i=d.value)!=null&&i.id){u.value=!0,r.value=null;try{r.value=await m("/assignment-process/1",{method:"POST"}),await N("/admin/assignments")}finally{u.value=!1}}}return _(g),(i,t)=>{var p;return a(),s("div",w,[t[3]||(t[3]=e("h1",{class:"h1 mb-4"},"Kursvergabe starten",-1)),b.value?(a(),s("div",A,"Lade aktuelle Phase...")):(a(),s("div",V,[e("p",B,[t[0]||(t[0]=k(" Aktuelle Phase: ")),e("strong",null,l(((p=d.value)==null?void 0:p.name)||"Unbekannt"),1)]),e("button",{onClick:h,disabled:u.value,class:"btn btn-primary mb-4"},l(u.value?"Vergabe läuft...":"Kursvergabe starten"),9,C),r.value&&r.value.students?(a(),s("div",I,[t[2]||(t[2]=e("h2",{class:"h5 mb-3"},"Vergabeübersicht",-1)),(a(!0),s(v,null,f(r.value.students,c=>(a(),s("div",{key:c.studentName,class:"mb-4 border rounded p-3 bg-light"},[e("h5",null,l(c.studentName),1),e("table",L,[t[1]||(t[1]=e("thead",null,[e("tr",null,[e("th",null,"Block"),e("th",null,"Kurs"),e("th",null,"Präferenz")])],-1)),e("tbody",null,[(a(!0),s(v,null,f(c.weeklyPlan,n=>(a(),s("tr",{key:n.blockLabel},[e("td",null,l(n.blockLabel),1),e("td",null,l(n.courseName),1),e("td",null,[e("span",{class:P({"text-muted":n.preferenceIndex===-1,"fw-bold":n.preferenceIndex===0})},l(n.preferenceIndex===-1?"PAUSE":n.preferenceIndex+1),3)])]))),128))])])]))),128))])):x("",!0)]))])}}};export{S as default};
