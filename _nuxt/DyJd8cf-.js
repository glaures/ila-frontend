import{e as A,i as F,g as K,r as _,k as L,m as I,n as M,c as o,a as e,h as r,t as a,K as v,q as N,C as D,ab as $,F as k,s as P,o as i,A as S,_ as E}from"./T0Q76loc.js";import{u as R}from"./Cz1D9uUY.js";import{w as T}from"./BA3RTNws.js";const U={class:"container-fluid py-4"},V={key:0,class:"text-center py-5"},q={key:1},G={class:"row mb-4"},W={class:"col-md-4"},j={class:"card border-danger"},H={class:"card-body"},J={class:"display-4 mb-0"},O={class:"text-muted"},Q={class:"col-md-4"},X={class:"card border-warning"},Y={class:"card-body"},Z={class:"display-4 mb-0"},ee={class:"text-muted"},se={class:"col-md-4"},te={class:"card border-success"},ae={class:"card-body"},le={class:"display-4 mb-0"},re={class:"text-muted"},ne={class:"card mb-4"},oe={class:"card-body"},ie={class:"progress",style:{height:"30px"}},de={class:"card mb-4"},ce={class:"card-body"},ue={class:"row align-items-center"},he={class:"col-md-9"},ge=["value"],_e={class:"card mb-4"},ve={class:"card-header"},be={class:"mb-0"},me={class:"card-body"},pe={key:0,class:"text-muted"},fe={key:1,class:"table-responsive"},ye={class:"table table-hover"},we={class:"progress",style:{"min-width":"100px"}},ke={key:2,class:"alert alert-warning"},Pe=A({__name:"preference-status",setup(Se){const{$authFetch:b}=F(),m=K(),p=R(),h=_(!0),g=_([]),c=_(null),l=_(null),u=L(()=>{var t;return((t=p.selectedPeriod)==null?void 0:t.id)??null});async function y(){var t;if(!u.value){g.value=[];return}try{const s=await b(`/blocks?period-id=${u.value}`);g.value=Array.isArray(s)?s:[]}catch(s){m.show(((t=s==null?void 0:s.data)==null?void 0:t.message)??"Fehler beim Laden der Blöcke: "+s),g.value=[]}}async function f(){var t;if(!u.value){m.show("Keine Periode ausgewählt"),h.value=!1;return}try{h.value=!0;let s=`/preference-status?period-id=${u.value}`;c.value&&(s+=`&block-id=${c.value}`),l.value=await b(s)}catch(s){m.show(((t=s==null?void 0:s.data)==null?void 0:t.message)??"Fehler beim Laden der Präferenz-Statistiken: "+s)}finally{h.value=!1}}function x(){f()}function d(t){return!l.value||l.value.totalStudents===0?0:Math.round(t/l.value.totalStudents*100)}function B(t){return t===0?"bg-warning text-dark":t===1?"bg-secondary":t===2?"bg-info":"bg-light text-dark"}function z(t){return t>=100?"bg-danger":t>=80?"bg-warning":"bg-success"}function C(t){return T[t]||t||"Unbekannt"}return I(async()=>{p.initialized||await p.loadPeriods(b),await y(),await f()}),M(u,async(t,s)=>{t&&t!==s&&(c.value=null,await y(),await f())}),(t,s)=>(i(),o("div",U,[s[9]||(s[9]=e("h1",{class:"mb-4"},"Präferenz-Eingaben Übersicht",-1)),r(h)?(i(),o("div",V,s[1]||(s[1]=[e("div",{class:"spinner-border text-primary",role:"status"},[e("span",{class:"visually-hidden"},"Lädt...")],-1)]))):r(l)?(i(),o("div",q,[e("div",G,[e("div",W,[e("div",j,[e("div",H,[s[2]||(s[2]=e("h5",{class:"card-title text-danger"},"Noch nicht begonnen",-1)),e("p",J,a(r(l).notStarted),1),e("small",O,a(d(r(l).notStarted))+"%",1)])])]),e("div",Q,[e("div",X,[e("div",Y,[s[3]||(s[3]=e("h5",{class:"card-title text-warning"},"In Bearbeitung",-1)),e("p",Z,a(r(l).inProgress),1),e("small",ee,a(d(r(l).inProgress))+"%",1)])])]),e("div",se,[e("div",te,[e("div",ae,[s[4]||(s[4]=e("h5",{class:"card-title text-success"},"Abgeschlossen",-1)),e("p",le,a(r(l).completed),1),e("small",re,a(d(r(l).completed))+"%",1)])])])]),e("div",ne,[e("div",oe,[s[5]||(s[5]=e("h5",{class:"card-title"},"Gesamtfortschritt",-1)),e("div",ie,[e("div",{class:"progress-bar bg-success",style:v({width:d(r(l).completed)+"%"}),role:"progressbar"},a(d(r(l).completed))+"% Fertig ",5),e("div",{class:"progress-bar bg-warning",style:v({width:d(r(l).inProgress)+"%"}),role:"progressbar"},a(d(r(l).inProgress))+"% ",5),e("div",{class:"progress-bar bg-danger",style:v({width:d(r(l).notStarted)+"%"}),role:"progressbar"},a(d(r(l).notStarted))+"% ",5)])])]),e("div",de,[e("div",ce,[e("div",ue,[s[7]||(s[7]=e("div",{class:"col-md-3"},[e("label",{for:"blockSelect",class:"form-label fw-bold"},"Block-Filter:")],-1)),e("div",he,[N(e("select",{id:"blockSelect",class:"form-select","onUpdate:modelValue":s[0]||(s[0]=n=>$(c)?c.value=n:null),onChange:x},[s[6]||(s[6]=e("option",{value:null},"Alle Blöcke",-1)),(i(!0),o(k,null,P(r(g),n=>(i(),o("option",{key:n.id,value:n.id},a(C(n.dayOfWeek))+", "+a(n.startTime)+" - "+a(n.endTime),9,ge))),128))],544),[[D,r(c)]])])])])]),e("div",_e,[e("div",ve,[e("h5",be,a(r(c)?"Beliebteste Kurse im ausgewählten Block":"Beliebteste Kurse (alle Blöcke)")+" (nach Prio-1-Platzierungen) ",1)]),e("div",me,[r(l).popularCourses.length===0?(i(),o("div",pe," Noch keine Präferenzen vorhanden ")):(i(),o("div",fe,[e("table",ye,[s[8]||(s[8]=e("thead",null,[e("tr",null,[e("th",null,"Rang"),e("th",null,"Kurs-ID"),e("th",null,"Kursname"),e("th",null,"Lehrer"),e("th",null,"Prio-1-Wahl"),e("th",null,"Max. Teilnehmer"),e("th",null,"Auslastung")])],-1)),e("tbody",null,[(i(!0),o(k,null,P(r(l).popularCourses,(n,w)=>(i(),o("tr",{key:n.courseId},[e("td",null,[e("span",{class:S(["badge",B(w)])},a(w+1),3)]),e("td",null,a(n.courseIdentifier),1),e("td",null,a(n.courseName),1),e("td",null,a(n.instructor),1),e("td",null,[e("strong",null,a(n.firstPreferenceCount),1)]),e("td",null,a(n.maxAttendees),1),e("td",null,[e("div",we,[e("div",{class:S(["progress-bar",z(n.utilizationPercentage)]),style:v({width:Math.min(n.utilizationPercentage,100)+"%"}),role:"progressbar"},a(n.utilizationPercentage)+"% ",7)])])]))),128))])])]))])])])):(i(),o("div",ke," Keine Daten verfügbar "))]))}}),Ce=E(Pe,[["__scopeId","data-v-d6c21912"]]);export{Ce as default};
