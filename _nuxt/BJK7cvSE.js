import{i as v,g as b,j as f,r as h,e as y,m as k,c as a,a as e,p as g,H as z,q as A,C as x,h as n,ab as C,F as K,s as S,d as F,ad as Z,o,t as B,_ as D}from"./DTeB4Gn8.js";const P=()=>{const{$authFetch:w}=v(),i=b(),d=f(),u=h(!1),l=h(null);return{isAssigning:u,assignmentResult:l,assignCourses:async _=>{var m;u.value=!0,l.value=null;try{const t=await w(`/periods/${_}/assign-courses`,{method:"POST"});return l.value=t,d.success("Kurszuweisung erfolgreich abgeschlossen!"),t}catch(t){return console.error("Fehler bei der Kurszuweisung:",t),i.show(((m=t==null?void 0:t.data)==null?void 0:m.message)??"Fehler bei der Kurszuweisung: "+t),null}finally{u.value=!1}}}},R={class:"container my-5"},V={class:"row"},M={class:"col-12"},N={class:"card mb-4"},T={class:"card-body"},$={class:"row align-items-center"},E={class:"col-md-6"},I=["disabled"],L=["value"],j={class:"col-md-6 mt-3 mt-md-0"},q=["disabled"],H={key:0,class:"spinner-border spinner-border-sm me-2"},O={key:1},U={key:2},G={key:0,class:"alert alert-warning mb-4"},J={key:1,class:"card mb-4"},Q=y({__name:"zuweisungs-prozess",setup(w){const{isAssigning:i,assignmentResult:d,assignCourses:u}=P(),l=h([]),r=h(null),_=async()=>{try{const{$authFetch:t}=v();l.value=await t("/periods");const s=l.value.find(p=>p.current);s&&(r.value=s.id)}catch(t){console.error("Fehler beim Laden der Zeiträume:",t)}},m=async()=>{!r.value||!confirm("Möchten Sie wirklich die Kurszuweisung für diesen Zeitraum durchführen? Alle bestehenden (nicht-manuellen) Zuweisungen werden gelöscht.")||await u(r.value)};return k(()=>{_()}),(t,s)=>{const p=Z("AssignmentResults");return o(),a("div",R,[e("div",V,[e("div",M,[s[5]||(s[5]=e("h1",{class:"mb-4"},"Kurszuweisung",-1)),e("div",N,[e("div",T,[s[2]||(s[2]=e("h5",{class:"card-title"},"Zeitraum auswählen",-1)),e("div",$,[e("div",E,[A(e("select",{"onUpdate:modelValue":s[0]||(s[0]=c=>C(r)?r.value=c:null),class:"form-select",disabled:n(i)},[s[1]||(s[1]=e("option",{value:null},"Bitte wählen...",-1)),(o(!0),a(K,null,S(n(l),c=>(o(),a("option",{key:c.id,value:c.id},B(c.name),9,L))),128))],8,I),[[x,n(r)]])]),e("div",j,[e("button",{class:"btn btn-primary btn-lg w-100",disabled:!n(r)||n(i),onClick:m},[n(i)?(o(),a("span",H)):g("",!0),n(i)?(o(),a("span",O,"Zuweisen läuft...")):(o(),a("span",U,"Kurse zuweisen"))],8,q)])])])]),n(r)?(o(),a("div",G,s[3]||(s[3]=[e("strong",null,"Achtung:",-1),F(" Die Kurszuweisung löscht alle bestehenden (nicht-manuellen) Zuweisungen für den gewählten Zeitraum und erstellt sie neu. Dieser Vorgang kann nicht rückgängig gemacht werden. ")]))):g("",!0),n(i)?(o(),a("div",J,s[4]||(s[4]=[e("div",{class:"card-body text-center py-5"},[e("div",{class:"spinner-border text-primary mb-3",style:{width:"3rem",height:"3rem"}}),e("h5",null,"Kurse werden zugewiesen..."),e("p",{class:"text-muted"},"Dies kann einige Minuten dauern.")],-1)]))):g("",!0),n(d)&&!n(i)?(o(),z(p,{key:2,result:n(d),class:"mb-4"},null,8,["result"])):g("",!0)])])])}}}),X=D(Q,[["__scopeId","data-v-1936b76b"]]);export{X as default};
