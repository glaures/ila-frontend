import{k as l,n as d,T as h,y as s,U as i,c as _,a as f,o as m}from"./DUJt4BQQ.js";const y={class:"container py-5 text-center"},b={__name:"auth-redirect",async setup(g){var c;let e,t;const u=d(),p=l(),n=u.query.code;if(n){const o=h(),r=`${o.public.baseUrl.replace(/\/$/,"")}${o.public.oauth.redirectPath}`;try{const{token:a}=([e,t]=s(()=>$fetch(o.public.apiBase+"/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:{code:n,redirectUri:r}})),e=await e,t(),e);localStorage.setItem("jwt",a),[e,t]=s(()=>i("/preferences")),await e,t()}catch(a){p.show(((c=a==null?void 0:a.data)==null?void 0:c.message)??"Es ist ein interner Fehler aufgetreten: "+a),[e,t]=s(()=>i("/")),await e,t()}}return(o,r)=>(m(),_("div",y,r[0]||(r[0]=[f("p",null,"Authentifiziere dichâ€¦",-1)])))}};export{b as default};
