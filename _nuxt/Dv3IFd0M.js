import{k as _,r as d,l as k,c as s,a as e,m as x,d as P,t as r,F as h,i as p,o as a,n as N,p as w}from"./Ea3BOCEV.js";const A={class:"p-4"},B={key:0,class:"text-muted"},L={key:1},V={class:"mb-2"},C=["disabled"],F={key:0,class:"mt-4"},I={class:"table table-sm table-bordered mt-2 mb-0"},f="http://localhost:8080",K={__name:"assign",setup(S){const{$authFetch:m}=_(),i=d(null),b=d(!0),o=d(!1),l=d(null);async function g(){try{i.value=await m(f+"/periods/current")}catch(u){console.error(u)}finally{b.value=!1}}async function y(){var u;if((u=i.value)!=null&&u.id){o.value=!0,l.value=null;try{l.value=await m(`${f}/assignments`,{method:"POST"}),await w("/admin/assignments")}catch(t){l.value="Fehler: "+t.message}finally{o.value=!1}}}return k(g),(u,t)=>{var v;return a(),s("div",A,[t[3]||(t[3]=e("h1",{class:"h4 mb-4"},"Kursvergabe starten",-1)),b.value?(a(),s("div",B,"Lade aktuelle Phase...")):(a(),s("div",L,[e("p",V,[t[0]||(t[0]=P(" Aktuelle Phase: ")),e("strong",null,r(((v=i.value)==null?void 0:v.name)||"Unbekannt"),1)]),e("button",{onClick:y,disabled:o.value,class:"btn btn-primary mb-4"},r(o.value?"Vergabe läuft...":"Kursvergabe starten"),9,C),l.value&&l.value.students?(a(),s("div",F,[t[2]||(t[2]=e("h2",{class:"h5 mb-3"},"Vergabeübersicht",-1)),(a(!0),s(h,null,p(l.value.students,c=>(a(),s("div",{key:c.studentName,class:"mb-4 border rounded p-3 bg-light"},[e("h5",null,r(c.studentName),1),e("table",I,[t[1]||(t[1]=e("thead",null,[e("tr",null,[e("th",null,"Block"),e("th",null,"Kurs"),e("th",null,"Präferenz")])],-1)),e("tbody",null,[(a(!0),s(h,null,p(c.weeklyPlan,n=>(a(),s("tr",{key:n.blockLabel},[e("td",null,r(n.blockLabel),1),e("td",null,r(n.courseName),1),e("td",null,[e("span",{class:N({"text-muted":n.preferenceIndex===-1,"fw-bold":n.preferenceIndex===0})},r(n.preferenceIndex===-1?"PAUSE":n.preferenceIndex+1),3)])]))),128))])])]))),128))])):x("",!0)]))])}}};export{K as default};
