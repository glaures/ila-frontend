import{_ as k}from"./PSH5XL05.js";import{_ as B}from"./DqrXf4xL.js";import{e as L,g as j,j as C,r as c,c as p,a as s,q as v,v as h,h as o,I as x,d as t,b as y,w as I,t as P,D as T,G as U,o as f,_ as V}from"./CZrh7myW.js";import{_ as A}from"./B9XM10IV.js";import{u as E}from"./DN_ooxGy.js";const N={class:"container min-vh-100 d-flex align-items-center justify-content-center"},z={class:"col-12 col-md-8 col-lg-5"},D={class:"card shadow-sm border-0"},K={class:"card-body p-3 p-md-5"},M={class:"mb-2"},R=["disabled"],J={class:"mb-3"},W=["disabled"],$=["disabled"],q={key:0},F={key:1,class:"d-inline-flex align-items-center"},G={class:"text-center"},O={class:"text-muted"},Y={class:"text-center mt-2"},Z={class:"text-muted"},H=L({__name:"login-internal",setup(Q){const b=T(),d=j(),w=C(),S=E(),r=c(""),a=c(""),n=c(!1);async function g(){var l;if(!n.value){if(!r.value.trim()){d.show("Bitte gib einen Benutzernamen ein.");return}if(!a.value){d.show("Bitte gib ein Passwort ein.");return}n.value=!0;try{const e=await $fetch("/login",{method:"POST",baseURL:b.public.apiBase,credentials:b.public.apiWithCredentials?"include":"omit",headers:{"Content-Type":"application/json"},body:{username:r.value.trim(),password:a.value}}),{token:m,username:u,roles:i}=e;localStorage.setItem("jwt",m),S.setUsername(u),console.log("roles: "+i),w.success("Erfolgreich angemeldet!"),await U("/instructor/home")}catch(e){console.error("Login error:",e),n.value=!1,d.show(((l=e==null?void 0:e.data)==null?void 0:l.message)??"Anmeldung fehlgeschlagen. Bitte überprüfe deine Zugangsdaten.")}}}function _(l){l.key==="Enter"&&g()}return(l,e)=>{const m=k,u=B;return f(),p("div",N,[s("div",z,[s("div",D,[s("div",K,[e[8]||(e[8]=s("div",{class:"text-center mb-3"},[s("img",{src:A,alt:"Logo der Johanna-Moosdorf-Schule",class:"img-fluid",style:{"max-height":"80px","object-fit":"contain"},loading:"eager"})],-1)),e[9]||(e[9]=s("h1",{class:"h4 mb-1 text-center"},"iLA Login",-1)),e[10]||(e[10]=s("p",{class:"text-muted mb-4 text-center"}," Anmeldung für Nutzer ohne IServ-Konto ",-1)),s("div",M,[e[2]||(e[2]=s("label",{for:"username",class:"form-label"},"Benutzername",-1)),v(s("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=i=>x(r)?r.value=i:null),type:"text",class:"form-control",placeholder:"Benutzername eingeben",disabled:o(n),autocomplete:"username",onKeypress:_},null,40,R),[[h,o(r)]])]),s("div",J,[e[3]||(e[3]=s("label",{for:"password",class:"form-label"},"Passwort",-1)),v(s("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=i=>x(a)?a.value=i:null),type:"password",class:"form-control",placeholder:"Passwort eingeben",disabled:o(n),autocomplete:"current-password",onKeypress:_},null,40,W),[[h,o(a)]])]),s("button",{type:"button",class:"btn btn-primary btn-lg w-100 d-flex align-items-center justify-content-center",disabled:o(n),onClick:g},[o(n)?(f(),p("span",F,e[4]||(e[4]=[s("span",{class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},null,-1),t(" Wird angemeldet… ")]))):(f(),p("span",q,"Anmelden"))],8,$),e[11]||(e[11]=s("div",{class:"mt-2 text-center"},[s("small",{class:"text-muted"},[t(" Probleme bei der Anmeldung? "),s("br"),t(" Support Email an "),s("a",{href:"mailto:support@sandbox27.de",class:"link-secondary"},"support@sandbox27.de"),t(" schreiben ")])],-1)),e[12]||(e[12]=s("hr",{class:"my-2"},null,-1)),s("div",G,[s("small",O,[e[6]||(e[6]=t(" Schüler melden sich über ")),y(m,{to:"/",class:"link-secondary"},{default:I(()=>e[5]||(e[5]=[t("IServ")])),_:1}),e[7]||(e[7]=t(" an. "))])])])]),s("div",Y,[s("small",Z,[t(" © "+P(new Date().getFullYear())+" Johanna-Moosdorf-Schule | ",1),y(u)])])])])}}}),oe=V(H,[["__scopeId","data-v-f807e0a2"]]);export{oe as default};
