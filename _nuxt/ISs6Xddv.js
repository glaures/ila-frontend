import{ak as A,z as D,r as u,i as F,P as L,G as T,c as a,a as n,j as d,m as x,v as K,F as b,l as w,t as l,d as U,o}from"./B9swkvS2.js";import{_ as z}from"./DlAUqK2U.js";const B={class:"container mt-4"},R={class:"mb-4"},q={key:0,class:"list-group"},M=["onClick"],P={key:0,class:"alert alert-success"},G={key:1,class:"alert alert-warning"},O={key:2,class:"alert alert-danger"},Z={key:3},H={class:"table table-sm"},J=["onClick"],Q={class:"mt-4"},W={key:0,class:"list-group"},X=["onClick"],Y={key:1,class:"mt-2"},ee={__name:"[[username]]",setup(se){const y=A(),{$authFetch:v}=D(),C=u([]),N=u([]),I=u([]),m=u(""),r=u(null),f=u(""),_=u([]),i=u(null),c=u({info:[],warning:[],error:[]}),p=F(()=>{const e=m.value;return e?C.value.filter(s=>{var t,g;return((t=s.firstName)==null?void 0:t.includes(e))||((g=s.lastName)==null?void 0:g.includes(e))}):[]});L(async()=>{var s;C.value=await v("/users"),N.value=await v("/courses");const e=(s=y.params)==null?void 0:s.username;if(e){const t=decodeURIComponent(e);h({userName:t}),m.value=t}});function h(e){r.value=e,m.value="",p.value=[],k()}async function k(){r.value&&(I.value=await v(`/assignments?user-name=${r.value.userName}`))}function V(){const e=f.value.toLowerCase();_.value=N.value.filter(s=>s.name.toLowerCase().includes(e)||s.courseId.toString().includes(e))}function $(e){console.log("course selected: "+e.name),i.value=e,f.value="",_.value=[]}async function E(){if(!r.value||!i.value)return;const e=await v("/assignments",{method:"POST",body:{userName:r.value.userName,courseId:i.value.courseId}});S(e),await k(),i.value=null}async function j(e){console.log("deleting "+e);const s=await v(`/assignments/${e}`,{method:"DELETE"});S(s),await k()}function S(e){console.log("feedback: "+e.info),c.value={info:e.info||[],warning:e.warning||[],error:e.error||[]}}return T(()=>{var e;return(e=y.params)==null?void 0:e.username},e=>{if(e){const s=decodeURIComponent(String(e));h(s)}}),(e,s)=>(o(),a("div",B,[s[5]||(s[5]=n("h1",{class:"mb-4"},"Kurszuweisungen verwalten",-1)),n("div",R,[s[2]||(s[2]=n("label",{class:"form-label"},"Schüler suchen",-1)),x(n("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t),class:"form-control",placeholder:"Vorname oder Nachname"},null,512),[[K,m.value]]),p.value.length&&m.value?(o(),a("ul",q,[(o(!0),a(b,null,w(p.value,t=>(o(),a("li",{class:"list-group-item list-group-item-action",key:t.username,onClick:g=>h(t)},l(t.firstName)+" "+l(t.lastName)+" ("+l(t.userName)+") ",9,M))),128))])):d("",!0)]),c.value.info.length?(o(),a("div",P,l(c.value.info.join(" ")),1)):d("",!0),c.value.warning.length?(o(),a("div",G,l(c.value.warning.join(" ")),1)):d("",!0),c.value.error.length?(o(),a("div",O,l(c.value.error.join(" ")),1)):d("",!0),r.value?(o(),a("div",Z,[n("h5",null,"Kurse von "+l(r.value.firstName)+" "+l(r.value.lastName),1),n("table",H,[s[3]||(s[3]=n("thead",null,[n("tr",null,[n("th",null,"Kurs"),n("th",null,"Aktion")])],-1)),n("tbody",null,[(o(!0),a(b,null,w(I.value,t=>(o(),a("tr",{key:t.id},[n("td",null,l(t.course.courseId)+": "+l(t.course.name),1),n("td",null,[n("button",{class:"btn btn-danger btn-sm",onClick:g=>j(t.id)},"Entfernen",8,J)])]))),128))])]),n("div",Q,[s[4]||(s[4]=n("label",{class:"form-label"},"Kurs hinzufügen",-1)),x(n("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>f.value=t),onInput:V,class:"form-control",placeholder:"Kursname oder Kurs-ID"},null,544),[[K,f.value]]),_.value.length&&f.value?(o(),a("ul",W,[(o(!0),a(b,null,w(_.value,t=>(o(),a("li",{class:"list-group-item list-group-item-action",key:t.courseId,onClick:g=>$(t)},l(t.name)+" ("+l(t.courseId)+") ",9,X))),128))])):d("",!0),i.value?(o(),a("div",Y,[U(l(i.value.courseId)+": "+l(i.value.name)+" ",1),n("button",{class:"btn btn-primary",onClick:E},"Zuweisen")])):d("",!0)])])):d("",!0)]))}},ae=z(ee,[["__scopeId","data-v-e2c06190"]]);export{ae as default};
