import{k as m,n as h,U as _,y as o,V as i,c as f,a as y,o as g}from"./Cc9q-tLu.js";import{u as w}from"./BfDo7UNv.js";const S={class:"container py-5 text-center"},x={__name:"auth-redirect",async setup(b){var c;let e,t;const u=h(),p=m(),l=w(),n=u.query.code;if(n){const s=_(),a=`${s.public.baseUrl.replace(/\/$/,"")}${s.public.oauth.redirectPath}`;try{const{token:r,username:d}=([e,t]=o(()=>$fetch(s.public.apiBase+"/auth",{method:"POST",headers:{"Content-Type":"application/json"},body:{code:n,redirectUri:a}})),e=await e,t(),e);localStorage.setItem("jwt",r),l.setUsername(d),[e,t]=o(()=>i("/preferences")),await e,t()}catch(r){p.show(((c=r==null?void 0:r.data)==null?void 0:c.message)??"Es ist ein interner Fehler aufgetreten: "+r),[e,t]=o(()=>i("/")),await e,t()}}return(s,a)=>(g(),f("div",S,a[0]||(a[0]=[y("p",null,"Authentifiziere dichâ€¦",-1)])))}};export{x as default};
